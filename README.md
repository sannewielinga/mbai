# Interpretable Hybrid Machine Learning Models Using FOLD-R++ and ASP

## Overview

This repository contains the source code, scripts, and data processing tools used in the paper "Interpretable Hybrid Machine Learning Models Using FOLD-R++ and Answer Set Programming". The approach integrates rules generated by the FOLD-R++ algorithm with black-box ML models (SVM, RF, KNN, MLP) to improve both accuracy and interpretability in classification tasks.

**Acknowledgement:**
This implementation builds upon the original FOLD-R++ algorithm and codebase introduced by Wang et al. in their publication and repository. For more details on FOLD-R++ and its original implementation, please refer to the FOLD-R++ repository: [FOLD-R++ Repository](https://github.com/hwd404/FOLD-R-PP)

## Components

- `data_loader.py`: Functions to load and preprocess the medical datasets.
- `foldrpp.py`: Implementation of FOLD-R++ algorithm (based on FOLD-R++ repository).
- `foldrpp_wrapper.py`: Train, convert, and apply FOLD-R++ rules. Also handles scaling and fact generation.
- `ml_models.py`: Training baseline ML models with scikit-learn.
- `hybrid_model.py`: Logic to combine ML model predictions with ASP rules using a fixed confidence threshold.
- `explainability.py`: Functions to generate and store explanations from the ASP rules.
- `main.py`: Main experiment script that runs the entire pipeline.

## How to Run

1. Install dependencies:
    - Python 3.x
    - `scikit-learn`, `numpy`, `pandas`, `scipy`
    - `clingo`
    ```bash
    pip3 install -r requirements.txt
    ```

2. Execute:
    ```bash
    python3 main.py
    ```
    This will run 10 experiments per model-dataset combination and produce results.

## Results and Output
- The script prints average accuracy, F1 scores, and statistical significance results.
- Induced ASP rules and explanations are stored in `results/` directory.
- Refer to the paper for details on interpreting outputs.